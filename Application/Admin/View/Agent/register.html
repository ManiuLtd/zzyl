<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>申请代理</title>
    <meta name="keywords" content="">
    <meta name="description" content="">
    <link rel="shortcut icon" href="favicon.ico"> <link href="__PUBLIC__/admin/css/bootstrap.min.css?v=3.3.6" rel="stylesheet">
    <link href="__PUBLIC__/admin/css/font-awesome.css?v=4.4.0" rel="stylesheet">
    <link href="__PUBLIC__/admin/css/plugins/iCheck/custom.css" rel="stylesheet">
    <link href="__PUBLIC__/admin/css/animate.css" rel="stylesheet">
    <link href="__PUBLIC__/admin/css/style.css?v=4.1.0" rel="stylesheet">
    <style>
        .form-group  label{
            width: 40%;
            max-width: 200px;
            float: left;
            height: 40px;
            line-height: 40px;
            padding: 0 10px 0 0 ;
            margin: 0;
            text-align: right;
        }
        .form-group  input{
            width: 60%;
            float: left;
            height: 40px;
            line-height: 40px;
            padding:0 0 0 10px ;
            margin: 0;
        }
    </style>
    <script type="text/javascript">
        //ajax post
        function apply(the) {
                var that = $(the);
                var url= that.attr('action');
                var cs = $(the).serialize();
                $.ajax({
                    url:url,
                    data:cs,
                    type:'POST',
                    dataType:'json',
                    success:function(data){
                        if (data.code==0){
                            //询问框
                            layer.confirm(data.msg, {
                                btn: ['确定'] //按钮
                            }, function(){
                                layer.closeAll(); //疯狂模式，关闭所有层
                                location.href="{:$_SERVER['HTTP_HOST'].'/agent.php/public/login'}"
                            });

                        }else{
                            layer.msg(data.msg);
                        }

                    }
                });

        }
        function ajax_post(the){
            if (username()&&bankcard()&&real_name()&&wechat()&&password()&&repassword()){
                apply(the)
                return false;
            }else{
                return false;
            }

        }
    </script>
</head>
<body class="gray-bg">
<div class="wrapper wrapper-content animated fadeInRight">
    <div class="row">
        <div class="col-sm-12">
            <div class="ibox float-e-margins">
                <div class="ibox-title">
                    <h5>申请代理</h5>
                </div>
                <div class="ibox-content">
                    <form method="post" class="form-horizontal" action="{:U()}" onsubmit="return ajax_post(this);">
                        <div class="form-group">
                            <label class="col-sm-2 control-label">代理账号(手机号):</label>
                            <div class="col-sm-10" id="input1">
                                <input type="text"  class="form-control" name="username" placeholder="请输入代理账号(手机号)" id="username"><img class="success"  style="display:none;margin-left: 10px;" src="__PUBLIC__/admin/img/success.png"><img class="error" style="display:none;margin-left: 10px;" src="__PUBLIC__/admin/img/error.png"><span class="s1"></span>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-sm-2 control-label">游戏ID:</label>
                            <div class="col-sm-10" id="input2">
                                <input type="text" class="form-control" value="{$userid}"  placeholder="请输入游戏ID"  >
                                <input type="hidden" class="form-control" value="{$userid}" name="userid" id="userid" >
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-sm-2 control-label">银行卡:</label>
                            <div class="col-sm-10" id="input3">
                                <input type="text"  class="form-control" name="bankcard" placeholder="银行卡" id="bankcard"><img  class="success" style="display:none;margin-left: 10px;" src="__PUBLIC__/admin/img/success.png"><img class="error" style="display:none;margin-left: 10px;" src="__PUBLIC__/admin/img/error.png"><span class="s1"></span>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-sm-2 control-label">持卡人姓名:</label>
                            <div class="col-sm-10" id="input4">
                                <input type="text"  class="form-control" name="real_name" placeholder="请填写银行卡开卡人姓名" id="real_name"><img class="success"  style="display:none;margin-left: 10px;" src="__PUBLIC__/admin/img/success.png"><img  style="display:none;margin-left: 10px;" class="error" src="__PUBLIC__/admin/img/error.png"><span class="s1"></span>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="col-sm-2 control-label">微信:</label>
                            <div class="col-sm-10" id="input5">
                                <input type="text"  class="form-control" name="wechat" placeholder="微信" id="wechat"><img class="success"  style="display:none;margin-left: 10px;" src="__PUBLIC__/admin/img/success.png"><img class="error"  style="display:none;margin-left: 10px;" src="__PUBLIC__/admin/img/error.png"><span class="s1"></span>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="col-sm-2 control-label">登录密码:</label>
                            <div class="col-sm-10" id="input6">
                                <input type="password" class="form-control" name="password" placeholder="请输入登录密码" id="password"><img class="success" style="display:none;margin-left: 10px;" src="__PUBLIC__/admin/img/success.png"><img class="error"  style="display:none;margin-left: 10px;" src="__PUBLIC__/admin/img/error.png"><span class="s1"></span>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-sm-2 control-label">确认密码:</label>
                            <div class="col-sm-10" id="input7">
                                <input type="password"  class="form-control" name="repassword" placeholder="请确认登录密码" id="repassword"><img class="success" style="display:none;margin-left: 10px;" src="__PUBLIC__/admin/img/success.png"><img  class="error" style="display:none;margin-left: 10px;" src="__PUBLIC__/admin/img/error.png"><span class="s1"></span>
                            </div>
                        </div>

                        <div class="hr-line-dashed"></div>
                        <div class="form-group" style="text-align: center">
                            <div class="col-sm-4 col-sm-offset-2">
                                <button id="b" class="btn btn-primary" type="submit">提交</button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- 全局js -->
<script src="__PUBLIC__/admin/js/jquery.min.js?v=2.1.4"></script>
<script src="__PUBLIC__/admin/js/bootstrap.min.js?v=3.3.6"></script>
<!-- 自定义js -->
<!--<script src="__PUBLIC__/admin/js/content.js?v=1.0.0"></script>-->
<!-- iCheck -->
<script src="__PUBLIC__/admin/js/plugins/iCheck/icheck.min.js"></script>
<script src="__PUBLIC__/admin/js/plugins/layer/layer.min.js"></script>
<script type="text/javascript">
    function username() {
        if($('#username').val() == ''){
            $(this).css('border','1px solid red');
            $('#input1 .error').show();
            $('#input1 .s1').html('<font color="red">&nbsp;请输入用户名</font>');
            return false;
        }else{
            var username = $('#username').val();
            var myreg = /^1[3|4|5|8][0-9]\d{4,8}$/;
             console.log(myreg.test(username));
            if(!myreg.test(username)){
                $('#username').css('border','1px solid red');
                $('#input1 .error').show();
                $('#input1 .s1').html('<font color="red">&nbsp;格式错误</font>');
                return false;
            }else{
                $('#input1 .success').show();
                $('#input1 .error').hide();
                $('#username').css('border','1px solid green');
                $('#input1 .s1').html('<font color="green">&nbsp;输入正确</font>');
                return true;
            }

            //ajax_check(username,1,'#username','#input1');
        }
    }
    $('#username').blur(function(){
        username();
    });
    function userid() {
        if($('#userid').val() == ''){
            $(this).css('border','1px solid red');
            $('#input2 .error').show();
            $('#input2 .s1').html('<font color="red">&nbsp;请输入游戏ID</font>');
            return false;
        }else{
            var userid = parseInt($('#userid').val());
            if(isNaN(userid)){
                $(this).css('border','1px solid red');
                $('#input2 .error').show();
                $('#input2 .s1').html('<font color="red">&nbsp;格式错误</font>');
                return false;
            }else{
                $('#input2 .success').show();
                $('#input2 .error').hide();
                $('#userid').css('border','1px solid green');
                $('#input2 .s1').html('<font color="green">&nbsp;输入正确</font>');
                return true;
            }
            //return true;
            //ajax请求判断是否合法
           // return ajax_check(userid,2,'#userid','#input2');
        }
    }
    $('#userid').blur(function(){
        userid()
    });
    function bankcard() {
        if($('#bankcard').val() == ''){
            $(this).css('border','1px solid red');
            $('#input3 .error').show();
            $('#input3 .s1').html('<font color="red">&nbsp;请输入银行卡号</font>');
            return false;
        }else{
            var bankcard = parseInt($('#bankcard').val());

            if(isNaN(bankcard)){
                $(this).css('border','1px solid red');
                $('#input3 .error').show();
                $('#input3 .s1').html('<font color="red">&nbsp;格式错误</font>');
                return false;
            }else if (bankcard.toString().length>20){
                $(this).css('border','1px solid red');
                $('#input3 .error').show();
                $('#input3 .success').hide();
                $('#input3 .s1').html('<font color="red">&nbsp;格式错误</font>');
                return false;
            } else{
                $('#input3 .success').show();
                $('#input3 .error').hide();
                $('#bankcard').css('border','1px solid green');
                $('#input3 .s1').html('<font color="green">&nbsp;输入正确</font>');
                return true;
            }
            return true;
            //ajax请求判断是否合法
            // ajax_check(bankcard,3,'#bankcard','#input3');
        }
    }
    $('#bankcard').blur(function(){
        bankcard()
    });
    function real_name() {
        if($('#real_name').val() == ''){
            $(this).css('border','1px solid red');
            $('#input4 .error').show();
            $('#input4 .s1').html('<font color="red">&nbsp;请输入持卡人姓名</font>');
            return false;
        }else{
            $('#input4 .success').show();
            $('#input4 .error').hide();
            $('#input4 .s1').html('<font color="green">&nbsp;输入正确</font>');
            return true;
        }
    }
    $('#real_name').blur(function(){
        real_name()
    });
    function wechat() {
        if($('#wechat').val() == ''){
            $(this).css('border','1px solid red');
            $('#input5 .error').show();
            $('#input5 .s1').html('<font color="red">&nbsp;请输入微信号</font>');
            return false;
        }else{
            var wechat = $('#wechat').val();

            $('#input5 .success').show();
            $('#input5 .error').hide();
            $('#wechat').css('border','1px solid green');
            $('#input5 .s1').html('<font color="green">&nbsp;输入正确</font>');
            return true;
            //ajax请求判断是否合法
            //ajax_check(wechat,5,'#wechat','#input5');
        }
    }
    $('#wechat').blur(function(){
        wechat()
    });
    function password() {
        if($('#password').val() == ''){
            $(this).css('border','1px solid red');
            $('#input6 .error').show();
            $('#input6 .s1').html('<font color="red">&nbsp;请输入密码</font>');
            return false;
        }else{
            var password = $('#password').val();
            if(password.length < 6){
                $(this).css('border','1px solid red');
                $('#input6 .error').show();
                $('#input6 .s1').html('<font color="red">&nbsp;密码最低6位数</font>');
                return false;
            }else{
                $('#input6 .success').show();
                $('#input6 .error').hide();
                $('#input6 .s1').html('<font color="green">&nbsp;输入正确</font>');
                return true;
            }
        }
    }
    $('#password').blur(function(){
        password()
    });
    function repassword() {
        if($('#repassword').val() == ''){
            $(this).css('border','1px solid red');
            $('#input7 .error').show();
            $('#input7 .s1').html('<font color="red">&nbsp;请再次输入密码</font>');
            return false;
        }else{
            if($('#repassword').val() != $('#password').val()){
                $(this).css('border','1px solid red');
                $('#input7 .error').show();
                $('#input7 .s1').html('<font color="red">&nbsp;两次密码不一致</font>');
                return false;
            }else{
                $('#input7 .success').show();
                $('#input7 .error').hide();
                $('#input7 .s1').html('<font color="green">&nbsp;输入正确</font>');
                return true;
            }
        }
    }
    $('#repassword').blur(function(){
        repassword()
    });
    function ajax_check(v,type,id,input){
        $.ajax({
            url:"{:U('ajax_check')}",
            data:{v:v,type:type},
            type:'GET',
            success:function(data){
                if(data.status==1){
                    $(input+' .success').show();
                    $(input+' .error').hide();
                    $(id).css('border','1px solid green');
                    $(input+' .s1').html('<font color="green">&nbsp;输入正确</font>');
                    return true;
                }else{
                    $(id).css('border','1px solid red');
                    $(input+' .error').show();
                    $(input+' .success').hide();
                    $(input+' .s1').html('<font color="red">&nbsp;已存在</font>');
                    return false;
                }
            }
        });
    }
</script>
</body>
</html>
